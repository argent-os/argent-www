(function(){'use strict';angular.module('app.core').controller('App',AppController);AppController.$inject=['config','$scope','$http','$state','$location','$window','$rootScope','shortHistory','AuthTokenFactory','UserFactory','CompanyFactory','OrganizationFactory'];function AppController(config,$scope,$http,$state,$location,$window,$rootScope,shortHistory,AuthTokenFactory,UserFactory,CompanyFactory,OrganizationFactory){var vm=this;var store=$window.localStorage;vm.title=config.appTitle;$scope.app=config;$scope.$state=$state;$scope.$location=$location;$scope.$window=$window;$rootScope.$on('$stateChangeStart',function(event){});$scope.$on('$stateChangeSuccess',function(event,toState,toParams,fromState,fromParams){});var time=Date.parse(store.getItem('timestamp'));if(time){if(time<Date.now()){localStorage.removeItem('satellizer_token');localStorage.removeItem('auth-token');localStorage.removeItem('timestamp');localStorage.removeItem('user');}}$rootScope.$on('$userSet',function(event,user){UserFactory.getProfile().then(function(response){vm.user=response.data;$rootScope.user=vm.user;});});UserFactory.authorize($location,$window);if(AuthTokenFactory.getToken()){UserFactory.getProfile().then(function(response){vm.user=response.data;$rootScope.user=vm.user;if(!vm.user){localStorage.clear();}});CompanyFactory.getCompany().then(function(response){vm.company=response.data;$rootScope.company=vm.company;});}$scope.stylePath='app/style/css/css_default/index_default.css';$scope.lightsOn='fa fa-moon-o';$scope.turnDefault='btn-warning';$scope.changePath=function(){$scope.stylePath=='app/style/css/css_default/index_default.css'?$scope.stylePath='app/style/css/css_inverse/index_inverse.css':$scope.stylePath='app/style/css/css_default/index_default.css';$scope.lightsOn=='fa fa-moon-o'?$scope.lightsOn='fa fa-lightbulb-o':$scope.lightsOn='fa fa-moon-o';$scope.turnDefault=='btn-warning'?$scope.turnDefault='btn-primary':$scope.turnDefault='btn-warning';};shortHistory.init($scope);}})();